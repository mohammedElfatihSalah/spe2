[34m[1mwandb[39m[22m: [33mWARNING[39m Calling wandb.run.save without any arguments is deprecated.Changes to attributes are automatically persisted.
I0410 11:14:01.726631 140018053883776 run.py:180] Using CLRS21 spec: {'train': {'num_samples': 1000, 'length': 16, 'seed': 11}, 'val': {'num_samples': 32, 'length': 16, 'seed': 21}, 'test': {'num_samples': 32, 'length': 64, 'seed': 31}}
I0410 11:14:05.487587 140018053883776 xla_bridge.py:253] Unable to initialize backend 'tpu_driver': NOT_FOUND: Unable to find driver in registry given worker:
2022-04-10 11:14:05.595240: E external/org_tensorflow/tensorflow/stream_executor/cuda/cuda_driver.cc:271] failed call to cuInit: CUDA_ERROR_NO_DEVICE: no CUDA-capable device is detected
I0410 11:14:05.595723 140018053883776 xla_bridge.py:253] Unable to initialize backend 'gpu': FAILED_PRECONDITION: No visible GPU devices.
I0410 11:14:05.596377 140018053883776 xla_bridge.py:253] Unable to initialize backend 'tpu': INVALID_ARGUMENT: TpuPlatform is not available.
W0410 11:14:05.596549 140018053883776 xla_bridge.py:257] No GPU/TPU found, falling back to CPU. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
manual >>  True
adj shape >>  (32, 20, 20)
manual >>  True
adj shape >>  (32, 20, 20)
manual >>  True
adj shape >>  (32, 20, 20)
manual >>  True
adj shape >>  (32, 20, 20)
manual >>  True
adj shape >>  (32, 20, 20)
I0410 11:14:39.167993 140018053883776 run.py:261] Compiled feedback step in 33.689578 s.
manual >>  True
adj shape >>  (32, 20, 20)
manual >>  True
adj shape >>  (32, 20, 20)
manual >>  True
adj shape >>  (32, 20, 20)
manual >>  True
adj shape >>  (32, 20, 20)
I0410 11:14:45.614794 140018053883776 run.py:276] (train) step 0: {'average_accuracy': 0.5842793491230992, 'average_shift': 4.65625}
I0410 11:14:50.205015 140018053883776 run.py:283] (val) step 0: {'average_accuracy': 0.5058807945526695, 'average_shift': 4.78125}
I0410 11:14:50.205241 140018053883776 run.py:329] Saving new checkpoint for average accuracy...
I0410 11:14:50.211220 140018053883776 run.py:334] Saving new checkpoint for average shift...
I0410 11:15:05.625688 140018053883776 run.py:276] (train) step 10: {'average_accuracy': 0.49867792569272834, 'average_shift': 2.84375}
I0410 11:15:05.662276 140018053883776 run.py:283] (val) step 10: {'average_accuracy': 0.5729141518204018, 'average_shift': 2.90625}
I0410 11:15:05.662483 140018053883776 run.py:329] Saving new checkpoint for average accuracy...
I0410 11:15:05.674059 140018053883776 run.py:334] Saving new checkpoint for average shift...
I0410 11:15:21.147828 140018053883776 run.py:276] (train) step 20: {'average_accuracy': 0.6096444762345496, 'average_shift': 3.90625}
I0410 11:15:21.184076 140018053883776 run.py:283] (val) step 20: {'average_accuracy': 0.5631255896880896, 'average_shift': 3.75}
I0410 11:15:21.184290 140018053883776 run.py:329] Saving new checkpoint for average accuracy...
I0410 11:15:36.765616 140018053883776 run.py:276] (train) step 30: {'average_accuracy': 0.459124211674763, 'average_shift': 3.1875}
I0410 11:15:36.799413 140018053883776 run.py:283] (val) step 30: {'average_accuracy': 0.480690836940837, 'average_shift': 2.96875}
I0410 11:15:36.799862 140018053883776 run.py:329] Saving new checkpoint for average accuracy...
Traceback (most recent call last):
  File "/usr/lib/python3.7/runpy.py", line 193, in _run_module_as_main
    "__main__", mod_spec)
  File "/usr/lib/python3.7/runpy.py", line 85, in _run_code
    exec(code, run_globals)
  File "/content/drive/MyDrive/Final Project/new_clrs/clrs/examples/run.py", line 411, in <module>
    app.run(main)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 312, in run
    _run_main(main, args)
  File "/usr/local/lib/python3.7/dist-packages/absl/app.py", line 258, in _run_main
    sys.exit(main(argv))
  File "/content/drive/MyDrive/Final Project/new_clrs/clrs/examples/run.py", line 258, in main
    cur_loss = model.feedback(feedback)
  File "/content/drive/MyDrive/Final Project/new_clrs/clrs/_src/baselines_2.py", line 970, in feedback
    feedback)
  File "/content/drive/MyDrive/Final Project/new_clrs/clrs/_src/baselines_2.py", line 1141, in update
    lss, grads = jax.value_and_grad(loss)(params, feedback)
  File "/usr/local/lib/python3.7/dist-packages/jax/_src/traceback_util.py", line 162, in reraise_with_filtered_traceback
    return fun(*args, **kwargs)
  File "/usr/local/lib/python3.7/dist-packages/jax/_src/api.py", line 958, in value_and_grad_f
    g = vjp_py(lax_internal._one(ans))
  File "/usr/local/lib/python3.7/dist-packages/jax/_src/tree_util.py", line 279, in __call__
    return self.fun(*args, **kw)
  File "/usr/local/lib/python3.7/dist-packages/jax/_src/api.py", line 2315, in _vjp_pullback_wrapper
    ans = fun(*args)
  File "/usr/local/lib/python3.7/dist-packages/jax/_src/tree_util.py", line 279, in __call__
    return self.fun(*args, **kw)
  File "/usr/local/lib/python3.7/dist-packages/jax/interpreters/ad.py", line 126, in unbound_vjp
    arg_cts = backward_pass(jaxpr, reduce_axes, True, consts, dummy_args, cts)
  File "/usr/local/lib/python3.7/dist-packages/jax/interpreters/ad.py", line 231, in backward_pass
    params, call_jaxpr, invals, cts_in, cts_in_avals, reduce_axes)
  File "/usr/local/lib/python3.7/dist-packages/jax/interpreters/ad.py", line 599, in call_transpose
    out_flat = primitive.bind(fun, *all_args, **new_params)
  File "/usr/local/lib/python3.7/dist-packages/jax/core.py", line 1709, in bind
    return call_bind(self, fun, *args, **params)
  File "/usr/local/lib/python3.7/dist-packages/jax/core.py", line 1721, in call_bind
    outs = top_trace.process_call(primitive, fun, tracers, params)
  File "/usr/local/lib/python3.7/dist-packages/jax/core.py", line 614, in process_call
    return primitive.impl(f, *tracers, **params)
  File "/usr/local/lib/python3.7/dist-packages/jax/_src/dispatch.py", line 143, in _xla_call_impl
    *unsafe_map(arg_spec, args))
  File "/usr/local/lib/python3.7/dist-packages/jax/linear_util.py", line 267, in memoized_fun
    result = cache.get(key, None)
  File "/usr/local/lib/python3.7/dist-packages/jax/core.py", line 1242, in __hash__
    tuple(self.named_shape.items())))
KeyboardInterrupt